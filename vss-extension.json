{
    "manifestVersion": 1,
    "id": "team-calendar",
    "version": "0.4.2",
    "publisher": "ms-devlabs",
    "name": "Team Calendar",
    "description": "Track events important to your team, view and manage days off, quickly see when sprints start and end, and more.",
    "public": true,
    "icons": {
        "default": "images/calendar-logo.png"
    },
    "tags": [
        "plan",
        "time",
        "calendar",
        "capacity",
        "awesomeness"
    ],
    "targets": [
        {
            "id": "Microsoft.VisualStudio.Services"
        }  
    ],
    "scopes": [
        "vso.work_write",
        "vso.notification_publish"
    ],
    "categories": [
        "Plan and track"
    ],
    "content": {
        "details": {
            "path": "overview.md"   
        },
        "license": {
            "path": "LICENSE.txt"
        }
    },
    "screenshots": [
        {
            "path": "images/calendar-screen-shot.png"
        }              
    ],
    "files": [
        {
            "path": "images",
            "addressable": true
        },
        {
            "path": "css",
            "addressable": true
        },  
        {
            "path": "calendar.html",
            "addressable": true
        },              
        {
            "path": "calendarServices.html",
            "addressable": true
        },
        {
            "path": "freeFormControls.html",
            "addressable": true  
        },
        {
            "path": "daysOffControls.html",
            "addressable": true  
        },                
        {
            "path": "built/min",
            "addressable": true
        },                
        {
            "path": "sdk",
            "addressable": true
        }
    ],
    "branding": {
        "color": "rgb(149, 37, 0)",
        "theme": "dark"
    },
    "contributions": [
        {
            "id": "calendar",
            "type": "ms.vss-web.hub",
            "description": "Calendar hub in the Home hub group.",
            "targets": [
                "ms.vss-web.home-hub-group"
            ],
            "properties": {
                "name": "Calendar",
                "order": 22,
                "uri": "calendar.html"
            }
        },
        {
            "id": "calendar-event-sources",
            "type": ".calendar-event-source-collection",
            "description": "Target for calendar event sources",
            "targets": [
                ".calendar"
            ]
        },
        {
            "id": "freeForm",
            "type": ".calendar-event-source",
            "description": "Calendar event source for free-form events. Enables users to add their own events to the calendar.",
            "targets": [
                ".calendar-event-sources"
            ],
            "properties": {
                "uri": "calendarServices.html"
            }
        },
        {
            "id": "add-freeform-control",
            "type": "ms.vss-web.control",
            "description": "",
            "targets": [
                ".calendar"
            ],
            "properties": {
                "uri": "freeFormControls.html"
            }
        },
        {
            "id": "daysOff",
            "type": ".calendar-event-source",
            "description": "Calendar event source for team and personal days off.",
            "targets": [
                ".calendar-event-sources"
            ],
            "properties": {
                "uri": "calendarServices.html"
            }
        },
        {
            "id": "add-daysoff-control",
            "type": "ms.vss-web.control",
            "description": "",
            "targets": [
                ".calendar"
            ],
            "properties": {
                "uri": "daysOffControls.html"
            }
        },
        {
            "id": "iterations",
            "type": ".calendar-event-source",
            "description": "Calendar event source for sprints/iterations.",
            "targets": [
                ".calendar-event-sources"
            ],
            "properties": {
                "uri": "calendarServices.html"
            }
        },
        {
            "id": "calendar-event-created-event",
            "type": "ms.vss-notifications.event-type",
            "targets": [ ".team-calendar-event-publisher" ],
            "properties": {
                "name": "Team Calendar event",
                "description": "Triggered when a new event is created in Team Calendar"
            }
        },
        {
            "id": "team-calendar-event-publisher",
            "type": "ms.vss-notifications.event-publisher",
            "targets": [ "ms.vss-notifications.events-publishers" ],
            "visibleTo": [
                "ms"
            ],
            "properties": {
                "serviceInstanceType": "00025394-6065-48CA-87D9-7F5672854EF7"
            }
        },  
        {
            "id": "calendar-event-created-subscription",
            "type": "ms.vss-notifications.subscription",
            "targets": [ "ms.vss-notifications.default-subscription-collection" ],
            "properties": {
                "description": "Default subscription to notify team members when a new event has been aded to the Team Calendar",
                "filter": {
                    "type": "Actor",
                    "eventType": "ms-devlabs.team-calendar.calendar-event-created-event",
                    "inclusions": [
                        "member"
                    ],
                    "exclusions": [ ],
                    "criteria": { }
                }
            }
        },
        {
            "id": "calendar-event-created-email-template",
            "type": "ms.vss-notifications.email-template",
            "targets": [ ".calendar-event-created-event" ],
            "includes": [
                "ms.vss-notifications.alert-email-template",
                ".calendar-event-details-section"
            ],
            "properties": {
                "format": "handlebars",
                "sourceTemplate": "ms.vss-notifications.alert-email-template",
                "inputs": {
                    "section-templates": [
                        "ms-devlabs.team-calendar.calendar-event-details-section"
                    ],
                    "email-subject": "New event on your Team Calendar",
                    "title": "New Team Calendar event created",
                    "action-notice": {
                        "isInfo": "true",
                        "message": "New notification"
                    },
                    "message": "A new event has been added to the team project <b>'{{ event.teamProjectName }}'</b>",
                    "alert-button": {
                        "title": "View calendar",
                        "url": "{{ event.calendarUrl }}"
                    },
                    "reason": "You are receiving this notification because you are a team member."
                }
            }
        },
        {
            "id": "calendar-event-details-section",
            "type": "ms.vss-notifications.template",
            "includes": [ "ms.vss-notifications.promo-without-cta" ],
            "properties": {
                "sourceTemplate": "ms.vss-notifications.promo-without-cta",
                "inputs": {
                    "title": "{{ event.calendarEvent.title }}",
                    "sub-title": "Created by {{ event.calendarEvent.member.displayName }}",
                    "content": "<p>Start date: {{ event.startDateString }} </p><p>End date: {{ event.endDateString }}</p>{{#if event.calendarEvent.description }}<p>Description: {{ event.calendarEvent.description }}</p>{{/if}}",
                    "imageSrc": "http://ms-devlabs.gallery.assets.tfsallin.net:8680/_apis/public/gallery/publisher/ms-devlabs/extension/team-calendar/0.4.11/assetbyname/Microsoft.VisualStudio.Services.Icons.Default"
                }
            }
        } 
    ],
    "contributionTypes": [
        {
            "id": "calendar-event-source-collection",
            "name": "Calendar event source collection",
            "description": "A collection of calendar event sources."
        },
        {
            "id": "calendar-event-source",
            "name": "Calendar event source",
            "description": "A provider of calendar events.",
            "properties": {
                "uri": {
                    "description": "URI to the (background/hidden) HTML content which registers the calendar event source object.",
                    "type": "string",
                    "required": true
                }
            }
        }]
}
